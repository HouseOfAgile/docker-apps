# generated by docker-apps
version: '3'

## Main service
## {{ service_main }}

services:
{% if service_main is defined %}
{{ service_config['app_main_service'] | indent(2,True) }}:
    build:
      context: {{ settings['current_path'] }}/../{{ settings['apps_path'] }}/{{ service_config['app_main_service'] }}
      dockerfile: Dockerfile
    container_name: {{ service_config['name'] }}
    hostname: {{ service_config['name'] }}
{% if service_main['ports'] %}
    ports:
{{ service_main['ports']  | indent(4,True) }}
{% else %}
    ports:
      - "8080:80"
{% endif %}
{% if service_main['networks'] %}
    networks:
{{ service_main['networks']  | indent(4,True) }}
{% else %}
    networks:
      - {{ settings['default_docker_network'] }}
{% endif %}
{# {{ service_main | to_nice_yaml | indent(4,True) }} #}
{% else %}
should be retrieved from docker hub or already build
{{ service_main }}
{% endif %}

## Other services
{#
{% for other_service in service_definition %}
# include definition for {{ other_service['name'] }}
{{ other_service['name']| indent(2,True) }}:
{{ other_service['config'] | indent(4,True) }}
{% endfor %}
#}
networks:
  {{ settings['default_docker_network'] }}:
    external: true
